<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Storm Shear & Updraft Calculator – Explained</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 2rem;
      background-color: #f0f8ff;
      line-height: 1.6;
    }
    .container {
      background: #fff;
      padding: 2rem;
      border-radius: 10px;
      max-width: 700px;
      margin: auto;
      box-shadow: 0px 0px 15px rgba(0,0,0,0.1);
    }
    h1, h2 {
      text-align: center;
      color: #333;
    }
    label {
      display: block;
      margin-top: 1.2rem;
      color: #333;
    }
    input[type="number"] {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }
    button {
      display: block;
      width: 100%;
      padding: 0.8rem;
      background: #007acc;
      color: #fff;
      border: none;
      border-radius: 4px;
      font-size: 1rem;
      cursor: pointer;
      margin-top: 1.5rem;
      transition: background 0.3s;
    }
    button:hover {
      background: #005fa3;
    }
    .result {
      margin-top: 1.5rem;
      padding: 1.2rem;
      background: #e9f5ff;
      border: 1px solid #b3d7ff;
      border-radius: 8px;
    }
    .formula {
      background: #eef;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-family: monospace;
    }
    .info {
      background: #fff8dc;
      padding: 1rem;
      border: 1px solid #f4e1a1;
      border-radius: 8px;
      margin-top: 1.5rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Storm Shear & Updraft Calculator</h1>
    <div class="info">
      <h2>About This Calculator</h2>
      <p>
        This tool helps estimate three important storm parameters:
      </p>
      <ul>
        <li><strong>Updraft Speed (w):</strong> How fast the storm air is rising (in m/s). We calculate this from <em>CAPE</em>, which tells us how much energy the storm has.</li>
        <li><strong>Effective Advective Wind (U<sub>eff</sub>):</strong> The average wind speed pushing the storm sideways, based on how tilted the storm looks.</li>
        <li><strong>Bulk Wind Shear (S):</strong> How quickly the wind speed increases with height. We use a default storm “height” of 6000 m – meaning we assume that if you go from the ground to 6000 m, the wind changes from near zero to roughly double the effective wind.</li>
      </ul>
      <p>
        In everyday terms, if you know the available energy (CAPE) and you observe the storm leaning at a certain angle, this calculator lets you back out the average wind that’s affecting the storm and how that wind changes with altitude.
      </p>
    </div>

    <h2>Inputs</h2>
    <label for="cape">CAPE (J/kg):</label>
    <input type="number" id="cape" placeholder="Enter CAPE (J/kg)" step="any" />

    <label for="angle">Storm Tilt Angle (θ in degrees):</label>
    <input type="number" id="angle" placeholder="Enter storm tilt angle" step="any" />
    
    <p>
      <em>Note:</em> A default vertical separation (storm height) of <strong>6000 m</strong> is assumed to estimate wind shear.
    </p>
    
    <button id="calcButton">Calculate Parameters</button>

    <div id="result" class="result" style="display:none;">
      <h2>Results</h2>
      
      <p><strong>Estimated Updraft Speed (w):</strong></p>
      <ul>
        <li><span id="updraft_mps"></span> m/s</li>
        <li><span id="updraft_knots"></span> knots</li>
        <li><span id="updraft_kmph"></span> km/h</li>
      </ul>
      
      <p><strong>Effective Advective Wind (U<sub>eff</sub>):</strong></p>
      <ul>
        <li><span id="wind_mps"></span> m/s</li>
        <li><span id="wind_knots"></span> knots</li>
        <li><span id="wind_kmph"></span> km/h</li>
      </ul>
      
      <p><strong>Estimated Bulk Wind Shear (S):</strong> 
         <span id="shear"></span> s<sup>-1</sup>
      </p>
      
      <p id="explanation"></p>
    </div>
  </div>

  <script>
    // Conversion factors
    const mpsToKnots = 1.94384;
    const mpsToKmph = 3.6;
    
    // Convert degrees to radians
    function degToRad(deg) {
      return deg * (Math.PI / 180);
    }
    
    // Utility function: round a number to a specified number of decimals
    function round(value, decimals) {
      return Number(Math.round(value + 'e' + decimals) + 'e-' + decimals);
    }

    document.getElementById("calcButton").addEventListener("click", function() {
      // Retrieve and parse input values
      const cape = parseFloat(document.getElementById("cape").value);
      const angleDeg = parseFloat(document.getElementById("angle").value);
      
      // Validate inputs
      if (isNaN(cape) || cape < 0 || isNaN(angleDeg)) {
        alert("Please make sure CAPE is non-negative and a valid angle is provided.");
        return;
      }
      
      // 1. Estimate updraft speed using CAPE: w = sqrt(2 * CAPE)
      const updraftSpeed = Math.sqrt(2 * cape);
      
      // 2. Convert tilt angle from degrees to radians and compute effective wind: U_eff = w * tan(θ)
      const angleRad = degToRad(angleDeg);
      const effectiveWind = updraftSpeed * Math.tan(angleRad);
      
      // 3. Calculate bulk wind shear using a default storm "height" (vertical separation Δz = 6000 m)
      //    We assume that the wind near the ground is nearly zero, so the wind at the top is roughly 2 x U_eff.
      //    The shear (S) is then: S = (2 * U_eff) / Δz.
      const defaultDeltaZ = 6000;
      const shear = (2 * effectiveWind) / defaultDeltaZ;
      
      // 4. Compute conversions for updraft speed and effective wind
      const updraftKnots = updraftSpeed * mpsToKnots;
      const updraftKmph = updraftSpeed * mpsToKmph;
      
      const windKnots = effectiveWind * mpsToKnots;
      const windKmph = effectiveWind * mpsToKmph;
      
      // Display the results in different units
      document.getElementById("updraft_mps").textContent = round(updraftSpeed, 2);
      document.getElementById("updraft_knots").textContent = round(updraftKnots, 2);
      document.getElementById("updraft_kmph").textContent = round(updraftKmph, 2);
      
      document.getElementById("wind_mps").textContent = round(effectiveWind, 2);
      document.getElementById("wind_knots").textContent = round(windKnots, 2);
      document.getElementById("wind_kmph").textContent = round(windKmph, 2);
      
      document.getElementById("shear").textContent = round(shear, 4);
      
      // Plain language explanation of formulas used
      document.getElementById("explanation").innerHTML =
        "Calculations used:<br>" +
        "<span class='formula'>w = √(2 × CAPE)</span> (Updraft speed in m/s)<br>" +
        "<span class='formula'>U<sub>eff</sub> = w × tan(θ)</span> (Sideways wind pushing the storm)<br>" +
        "<span class='formula'>S = (2 × U<sub>eff</sub>) / Δz</span><br>" +
        "<em>Assuming a storm height of " + defaultDeltaZ + " m</em><br>" +
        "In simple terms, the wind increases from nearly 0 at the ground to about twice the effective wind at the top.";
      
      document.getElementById("result").style.display = "block";
    });
  </script>
</body>
</html>
